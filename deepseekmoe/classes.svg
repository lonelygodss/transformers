<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Title: classes Pages: 1 -->
<svg width="7366pt" height="1235pt"
 viewBox="0.00 0.00 7366.40 1235.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1231)">
<title>classes</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1231 7362.4,-1231 7362.4,4 -4,4"/>
<!-- modeling_deepseek.AddAuxiliaryLoss -->
<g id="node1" class="node">
<title>modeling_deepseek.AddAuxiliaryLoss</title>
<polygon fill="none" stroke="black" points="136.88,-78.75 136.88,-144.25 303.62,-144.25 303.62,-78.75 136.88,-78.75"/>
<text text-anchor="start" x="170" y="-126.95" font-family="Times New Roman,serif" font-size="14.00">AddAuxiliaryLoss</text>
<polyline fill="none" stroke="black" points="136.88,-119.75 303.62,-119.75"/>
<polyline fill="none" stroke="black" points="136.88,-119.75 303.62,-119.75"/>
<text text-anchor="start" x="144.88" y="-102.45" font-family="Times New Roman,serif" font-size="14.00">backward(ctx, grad_output)</text>
<text text-anchor="start" x="144.88" y="-85.95" font-family="Times New Roman,serif" font-size="14.00">forward(ctx, x, loss)</text>
</g>
<!-- modeling_deepseek.DeepseekAttention -->
<g id="node2" class="node">
<title>modeling_deepseek.DeepseekAttention</title>
<polygon fill="none" stroke="black" points="0,-485.5 0,-806.5 1508.5,-806.5 1508.5,-485.5 0,-485.5"/>
<text text-anchor="start" x="702.5" y="-789.2" font-family="Times New Roman,serif" font-size="14.00">DeepseekAttention</text>
<polyline fill="none" stroke="black" points="0,-782 1508.5,-782"/>
<text text-anchor="start" x="680.75" y="-764.7" font-family="Times New Roman,serif" font-size="14.00">attention_dropout</text>
<text text-anchor="start" x="680.75" y="-748.2" font-family="Times New Roman,serif" font-size="14.00">config</text>
<text text-anchor="start" x="680.75" y="-731.7" font-family="Times New Roman,serif" font-size="14.00">head_dim</text>
<text text-anchor="start" x="680.75" y="-715.2" font-family="Times New Roman,serif" font-size="14.00">hidden_size</text>
<text text-anchor="start" x="680.75" y="-698.7" font-family="Times New Roman,serif" font-size="14.00">is_causal : bool</text>
<text text-anchor="start" x="680.75" y="-682.2" font-family="Times New Roman,serif" font-size="14.00">k_proj : Linear</text>
<text text-anchor="start" x="680.75" y="-665.7" font-family="Times New Roman,serif" font-size="14.00">layer_idx : Optional[int]</text>
<text text-anchor="start" x="680.75" y="-649.2" font-family="Times New Roman,serif" font-size="14.00">max_position_embeddings</text>
<text text-anchor="start" x="680.75" y="-632.7" font-family="Times New Roman,serif" font-size="14.00">num_heads</text>
<text text-anchor="start" x="680.75" y="-616.2" font-family="Times New Roman,serif" font-size="14.00">num_key_value_groups</text>
<text text-anchor="start" x="680.75" y="-599.7" font-family="Times New Roman,serif" font-size="14.00">num_key_value_heads</text>
<text text-anchor="start" x="680.75" y="-583.2" font-family="Times New Roman,serif" font-size="14.00">o_proj : Linear</text>
<text text-anchor="start" x="680.75" y="-566.7" font-family="Times New Roman,serif" font-size="14.00">q_proj : Linear</text>
<text text-anchor="start" x="680.75" y="-550.2" font-family="Times New Roman,serif" font-size="14.00">rope_theta</text>
<text text-anchor="start" x="680.75" y="-533.7" font-family="Times New Roman,serif" font-size="14.00">rotary_emb</text>
<text text-anchor="start" x="680.75" y="-517.2" font-family="Times New Roman,serif" font-size="14.00">v_proj : Linear</text>
<polyline fill="none" stroke="black" points="0,-510 1508.5,-510"/>
<text text-anchor="start" x="8" y="-492.7" font-family="Times New Roman,serif" font-size="14.00">forward(hidden_states: torch.Tensor, attention_mask: Optional[torch.Tensor], position_ids: Optional[torch.LongTensor], past_key_value: Optional[Cache], output_attentions: bool, use_cache: bool): Tuple[torch.Tensor, Optional[torch.Tensor], Optional[Tuple[torch.Tensor]]]</text>
</g>
<!-- modeling_deepseek.DeepseekDecoderLayer -->
<g id="node3" class="node">
<title>modeling_deepseek.DeepseekDecoderLayer</title>
<polygon fill="none" stroke="black" points="3271.12,-576.25 3271.12,-715.75 4993.38,-715.75 4993.38,-576.25 3271.12,-576.25"/>
<text text-anchor="start" x="4067.38" y="-698.45" font-family="Times New Roman,serif" font-size="14.00">DeepseekDecoderLayer</text>
<polyline fill="none" stroke="black" points="3271.12,-691.25 4993.38,-691.25"/>
<text text-anchor="start" x="4062.5" y="-673.95" font-family="Times New Roman,serif" font-size="14.00">hidden_size</text>
<text text-anchor="start" x="4062.5" y="-657.45" font-family="Times New Roman,serif" font-size="14.00">input_layernorm</text>
<text text-anchor="start" x="4062.5" y="-640.95" font-family="Times New Roman,serif" font-size="14.00">mlp</text>
<text text-anchor="start" x="4062.5" y="-624.45" font-family="Times New Roman,serif" font-size="14.00">post_attention_layernorm</text>
<text text-anchor="start" x="4062.5" y="-607.95" font-family="Times New Roman,serif" font-size="14.00">self_attn</text>
<polyline fill="none" stroke="black" points="3271.12,-600.75 4993.38,-600.75"/>
<text text-anchor="start" x="3279.12" y="-583.45" font-family="Times New Roman,serif" font-size="14.00">forward(hidden_states: torch.Tensor, attention_mask: Optional[torch.Tensor], position_ids: Optional[torch.LongTensor], past_key_value: Optional[Tuple[torch.Tensor]], output_attentions: Optional[bool], use_cache: Optional[bool]): Tuple[torch.FloatTensor, Optional[Tuple[torch.FloatTensor, torch.FloatTensor]]]</text>
</g>
<!-- modeling_deepseek.DeepseekDynamicNTKScalingRotaryEmbedding -->
<g id="node4" class="node">
<title>modeling_deepseek.DeepseekDynamicNTKScalingRotaryEmbedding</title>
<polygon fill="none" stroke="black" points="321.88,-66.5 321.88,-156.5 608.62,-156.5 608.62,-66.5 321.88,-66.5"/>
<text text-anchor="start" x="329.88" y="-139.2" font-family="Times New Roman,serif" font-size="14.00">DeepseekDynamicNTKScalingRotaryEmbedding</text>
<polyline fill="none" stroke="black" points="321.88,-132 608.62,-132"/>
<text text-anchor="start" x="407.12" y="-114.7" font-family="Times New Roman,serif" font-size="14.00">max_seq_len_cached</text>
<text text-anchor="start" x="407.12" y="-98.2" font-family="Times New Roman,serif" font-size="14.00">scaling_factor : float</text>
<polyline fill="none" stroke="black" points="321.88,-91 608.62,-91"/>
<text text-anchor="start" x="463.38" y="-73.7" font-family="Times New Roman,serif" font-size="14.00"> </text>
</g>
<!-- modeling_deepseek.DeepseekDynamicNTKScalingRotaryEmbedding&#45;&gt;modeling_deepseek.DeepseekAttention -->
<g id="edge8" class="edge">
<title>modeling_deepseek.DeepseekDynamicNTKScalingRotaryEmbedding&#45;&gt;modeling_deepseek.DeepseekAttention</title>
<path fill="none" stroke="black" d="M448.91,-156.91C428,-221.63 399.69,-343.8 446.25,-432.5 454.21,-447.66 463.79,-461.95 474.58,-475.39"/>
<polygon fill="black" stroke="black" points="474.36,-475.13 481.28,-477.16 482.07,-484.33 475.15,-482.3 474.36,-475.13"/>
<text text-anchor="middle" x="477.75" y="-348.95" font-family="Times New Roman,serif" font-size="14.00" fill="green">rotary_emb</text>
</g>
<!-- modeling_deepseek.DeepseekRotaryEmbedding -->
<g id="node14" class="node">
<title>modeling_deepseek.DeepseekRotaryEmbedding</title>
<polygon fill="none" stroke="black" points="518.38,-292.5 518.38,-415.5 718.12,-415.5 718.12,-292.5 518.38,-292.5"/>
<text text-anchor="start" x="542.12" y="-398.2" font-family="Times New Roman,serif" font-size="14.00">DeepseekRotaryEmbedding</text>
<polyline fill="none" stroke="black" points="518.38,-391 718.12,-391"/>
<text text-anchor="start" x="526.38" y="-373.7" font-family="Times New Roman,serif" font-size="14.00">base : int</text>
<text text-anchor="start" x="526.38" y="-357.2" font-family="Times New Roman,serif" font-size="14.00">dim</text>
<text text-anchor="start" x="526.38" y="-340.7" font-family="Times New Roman,serif" font-size="14.00">max_position_embeddings : int</text>
<text text-anchor="start" x="526.38" y="-324.2" font-family="Times New Roman,serif" font-size="14.00">max_seq_len_cached : NoneType</text>
<polyline fill="none" stroke="black" points="518.38,-317 718.12,-317"/>
<text text-anchor="start" x="564.62" y="-299.7" font-family="Times New Roman,serif" font-size="14.00">forward(x, seq_len)</text>
</g>
<!-- modeling_deepseek.DeepseekDynamicNTKScalingRotaryEmbedding&#45;&gt;modeling_deepseek.DeepseekRotaryEmbedding -->
<g id="edge1" class="edge">
<title>modeling_deepseek.DeepseekDynamicNTKScalingRotaryEmbedding&#45;&gt;modeling_deepseek.DeepseekRotaryEmbedding</title>
<path fill="none" stroke="black" d="M493.49,-156.89C515.87,-192.07 547.57,-241.9 573.41,-282.52"/>
<polygon fill="none" stroke="black" points="570.38,-284.27 578.7,-290.83 576.28,-280.51 570.38,-284.27"/>
</g>
<!-- modeling_deepseek.DeepseekFlashAttention2 -->
<g id="node5" class="node">
<title>modeling_deepseek.DeepseekFlashAttention2</title>
<polygon fill="none" stroke="black" points="835.75,-329.5 835.75,-378.5 2372.75,-378.5 2372.75,-329.5 835.75,-329.5"/>
<text text-anchor="start" x="1534.5" y="-361.2" font-family="Times New Roman,serif" font-size="14.00">DeepseekFlashAttention2</text>
<polyline fill="none" stroke="black" points="835.75,-354 2372.75,-354"/>
<polyline fill="none" stroke="black" points="835.75,-354 2372.75,-354"/>
<text text-anchor="start" x="843.75" y="-336.7" font-family="Times New Roman,serif" font-size="14.00">forward(hidden_states: torch.Tensor, attention_mask: Optional[torch.LongTensor], position_ids: Optional[torch.LongTensor], past_key_value: Optional[Cache], output_attentions: bool, use_cache: bool): Tuple[torch.Tensor, Optional[torch.Tensor], Optional[Tuple[torch.Tensor]]]</text>
</g>
<!-- modeling_deepseek.DeepseekFlashAttention2&#45;&gt;modeling_deepseek.DeepseekAttention -->
<g id="edge2" class="edge">
<title>modeling_deepseek.DeepseekFlashAttention2&#45;&gt;modeling_deepseek.DeepseekAttention</title>
<path fill="none" stroke="black" d="M1533.97,-378.98C1464.61,-402.64 1352.07,-441.04 1233.79,-481.39"/>
<polygon fill="none" stroke="black" points="1232.84,-478.02 1224.5,-484.56 1235.1,-484.64 1232.84,-478.02"/>
</g>
<!-- modeling_deepseek.DeepseekForCausalLM -->
<g id="node6" class="node">
<title>modeling_deepseek.DeepseekForCausalLM</title>
<polygon fill="none" stroke="black" points="2521.5,-860 2521.5,-1082 4873,-1082 4873,-860 2521.5,-860"/>
<text text-anchor="start" x="3632.75" y="-1064.7" font-family="Times New Roman,serif" font-size="14.00">DeepseekForCausalLM</text>
<polyline fill="none" stroke="black" points="2521.5,-1057.5 4873,-1057.5"/>
<text text-anchor="start" x="3650.38" y="-1040.2" font-family="Times New Roman,serif" font-size="14.00">lm_head : Linear</text>
<text text-anchor="start" x="3650.38" y="-1023.7" font-family="Times New Roman,serif" font-size="14.00">model</text>
<text text-anchor="start" x="3650.38" y="-1007.2" font-family="Times New Roman,serif" font-size="14.00">vocab_size</text>
<polyline fill="none" stroke="black" points="2521.5,-1000 4873,-1000"/>
<text text-anchor="start" x="2529.5" y="-982.7" font-family="Times New Roman,serif" font-size="14.00">forward(input_ids: torch.LongTensor, attention_mask: Optional[torch.Tensor], position_ids: Optional[torch.LongTensor], past_key_values: Optional[List[torch.FloatTensor]], inputs_embeds: Optional[torch.FloatTensor], labels: Optional[torch.LongTensor], use_cache: Optional[bool], output_attentions: Optional[bool], output_hidden_states: Optional[bool], return_dict: Optional[bool]): Union[Tuple, CausalLMOutputWithPast]</text>
<text text-anchor="start" x="2529.5" y="-966.2" font-family="Times New Roman,serif" font-size="14.00">get_decoder()</text>
<text text-anchor="start" x="2529.5" y="-949.7" font-family="Times New Roman,serif" font-size="14.00">get_input_embeddings()</text>
<text text-anchor="start" x="2529.5" y="-933.2" font-family="Times New Roman,serif" font-size="14.00">get_output_embeddings()</text>
<text text-anchor="start" x="2529.5" y="-916.7" font-family="Times New Roman,serif" font-size="14.00">prepare_inputs_for_generation(input_ids, past_key_values, attention_mask, inputs_embeds)</text>
<text text-anchor="start" x="2529.5" y="-900.2" font-family="Times New Roman,serif" font-size="14.00">set_decoder(decoder)</text>
<text text-anchor="start" x="2529.5" y="-883.7" font-family="Times New Roman,serif" font-size="14.00">set_input_embeddings(value)</text>
<text text-anchor="start" x="2529.5" y="-867.2" font-family="Times New Roman,serif" font-size="14.00">set_output_embeddings(new_embeddings)</text>
</g>
<!-- modeling_deepseek.DeepseekPreTrainedModel -->
<g id="node12" class="node">
<title>modeling_deepseek.DeepseekPreTrainedModel</title>
<polygon fill="none" stroke="black" points="5973.62,-1120 5973.62,-1226.5 6204.88,-1226.5 6204.88,-1120 5973.62,-1120"/>
<text text-anchor="start" x="6015" y="-1209.2" font-family="Times New Roman,serif" font-size="14.00">DeepseekPreTrainedModel</text>
<polyline fill="none" stroke="black" points="5973.62,-1202 6204.88,-1202"/>
<text text-anchor="start" x="5981.62" y="-1184.7" font-family="Times New Roman,serif" font-size="14.00">base_model_prefix : str</text>
<text text-anchor="start" x="5981.62" y="-1168.2" font-family="Times New Roman,serif" font-size="14.00">config_class</text>
<text text-anchor="start" x="5981.62" y="-1151.7" font-family="Times New Roman,serif" font-size="14.00">supports_gradient_checkpointing : bool</text>
<polyline fill="none" stroke="black" points="5973.62,-1144.5 6204.88,-1144.5"/>
<text text-anchor="start" x="6087.38" y="-1127.2" font-family="Times New Roman,serif" font-size="14.00"> </text>
</g>
<!-- modeling_deepseek.DeepseekForCausalLM&#45;&gt;modeling_deepseek.DeepseekPreTrainedModel -->
<g id="edge3" class="edge">
<title>modeling_deepseek.DeepseekForCausalLM&#45;&gt;modeling_deepseek.DeepseekPreTrainedModel</title>
<path fill="none" stroke="black" d="M4873.14,-1081.82C4875.85,-1082.05 4878.55,-1082.27 4881.25,-1082.5 5275.19,-1115.51 5741.94,-1148.44 5962.16,-1163.6"/>
<polygon fill="none" stroke="black" points="5961.7,-1167.08 5971.91,-1164.27 5962.18,-1160.09 5961.7,-1167.08"/>
</g>
<!-- modeling_deepseek.DeepseekForSequenceClassification -->
<g id="node7" class="node">
<title>modeling_deepseek.DeepseekForSequenceClassification</title>
<polygon fill="none" stroke="black" points="4890.62,-901.25 4890.62,-1040.75 7287.88,-1040.75 7287.88,-901.25 4890.62,-901.25"/>
<text text-anchor="start" x="5990.62" y="-1023.45" font-family="Times New Roman,serif" font-size="14.00">DeepseekForSequenceClassification</text>
<polyline fill="none" stroke="black" points="4890.62,-1016.25 7287.88,-1016.25"/>
<text text-anchor="start" x="6051.75" y="-998.95" font-family="Times New Roman,serif" font-size="14.00">model</text>
<text text-anchor="start" x="6051.75" y="-982.45" font-family="Times New Roman,serif" font-size="14.00">num_labels</text>
<text text-anchor="start" x="6051.75" y="-965.95" font-family="Times New Roman,serif" font-size="14.00">score : Linear</text>
<polyline fill="none" stroke="black" points="4890.62,-958.75 7287.88,-958.75"/>
<text text-anchor="start" x="4898.62" y="-941.45" font-family="Times New Roman,serif" font-size="14.00">forward(input_ids: torch.LongTensor, attention_mask: Optional[torch.Tensor], position_ids: Optional[torch.LongTensor], past_key_values: Optional[List[torch.FloatTensor]], inputs_embeds: Optional[torch.FloatTensor], labels: Optional[torch.LongTensor], use_cache: Optional[bool], output_attentions: Optional[bool], output_hidden_states: Optional[bool], return_dict: Optional[bool]): Union[Tuple, SequenceClassifierOutputWithPast]</text>
<text text-anchor="start" x="4898.62" y="-924.95" font-family="Times New Roman,serif" font-size="14.00">get_input_embeddings()</text>
<text text-anchor="start" x="4898.62" y="-908.45" font-family="Times New Roman,serif" font-size="14.00">set_input_embeddings(value)</text>
</g>
<!-- modeling_deepseek.DeepseekForSequenceClassification&#45;&gt;modeling_deepseek.DeepseekPreTrainedModel -->
<g id="edge4" class="edge">
<title>modeling_deepseek.DeepseekForSequenceClassification&#45;&gt;modeling_deepseek.DeepseekPreTrainedModel</title>
<path fill="none" stroke="black" d="M6089.25,-1041.2C6089.25,-1063.04 6089.25,-1087.07 6089.25,-1108.52"/>
<polygon fill="none" stroke="black" points="6085.75,-1108.29 6089.25,-1118.29 6092.75,-1108.29 6085.75,-1108.29"/>
</g>
<!-- modeling_deepseek.DeepseekLinearScalingRotaryEmbedding -->
<g id="node8" class="node">
<title>modeling_deepseek.DeepseekLinearScalingRotaryEmbedding</title>
<polygon fill="none" stroke="black" points="628.25,-66.5 628.25,-156.5 872.25,-156.5 872.25,-66.5 628.25,-66.5"/>
<text text-anchor="start" x="636.25" y="-139.2" font-family="Times New Roman,serif" font-size="14.00">DeepseekLinearScalingRotaryEmbedding</text>
<polyline fill="none" stroke="black" points="628.25,-132 872.25,-132"/>
<text text-anchor="start" x="692.12" y="-114.7" font-family="Times New Roman,serif" font-size="14.00">max_seq_len_cached</text>
<text text-anchor="start" x="692.12" y="-98.2" font-family="Times New Roman,serif" font-size="14.00">scaling_factor : float</text>
<polyline fill="none" stroke="black" points="628.25,-91 872.25,-91"/>
<text text-anchor="start" x="748.38" y="-73.7" font-family="Times New Roman,serif" font-size="14.00"> </text>
</g>
<!-- modeling_deepseek.DeepseekLinearScalingRotaryEmbedding&#45;&gt;modeling_deepseek.DeepseekAttention -->
<g id="edge9" class="edge">
<title>modeling_deepseek.DeepseekLinearScalingRotaryEmbedding&#45;&gt;modeling_deepseek.DeepseekAttention</title>
<path fill="none" stroke="black" d="M750.58,-156.98C751.1,-225.69 752.12,-361.28 752.95,-472.13"/>
<polygon fill="black" stroke="black" points="752.95,-472.28 757,-478.25 753.04,-484.28 749,-478.31 752.95,-472.28"/>
<text text-anchor="middle" x="784.15" y="-348.95" font-family="Times New Roman,serif" font-size="14.00" fill="green">rotary_emb</text>
</g>
<!-- modeling_deepseek.DeepseekLinearScalingRotaryEmbedding&#45;&gt;modeling_deepseek.DeepseekRotaryEmbedding -->
<g id="edge5" class="edge">
<title>modeling_deepseek.DeepseekLinearScalingRotaryEmbedding&#45;&gt;modeling_deepseek.DeepseekRotaryEmbedding</title>
<path fill="none" stroke="black" d="M725.89,-156.89C706.62,-192 679.34,-241.69 657.07,-282.27"/>
<polygon fill="none" stroke="black" points="654.15,-280.33 652.4,-290.78 660.28,-283.69 654.15,-280.33"/>
</g>
<!-- modeling_deepseek.DeepseekMLP -->
<g id="node9" class="node">
<title>modeling_deepseek.DeepseekMLP</title>
<polygon fill="none" stroke="black" points="3851.5,-25.25 3851.5,-197.75 4031,-197.75 4031,-25.25 3851.5,-25.25"/>
<text text-anchor="start" x="3900.75" y="-180.45" font-family="Times New Roman,serif" font-size="14.00">DeepseekMLP</text>
<polyline fill="none" stroke="black" points="3851.5,-173.25 4031,-173.25"/>
<text text-anchor="start" x="3859.5" y="-155.95" font-family="Times New Roman,serif" font-size="14.00">act_fn</text>
<text text-anchor="start" x="3859.5" y="-139.45" font-family="Times New Roman,serif" font-size="14.00">config</text>
<text text-anchor="start" x="3859.5" y="-122.95" font-family="Times New Roman,serif" font-size="14.00">down_proj : Linear</text>
<text text-anchor="start" x="3859.5" y="-106.45" font-family="Times New Roman,serif" font-size="14.00">gate_proj : Linear</text>
<text text-anchor="start" x="3859.5" y="-89.95" font-family="Times New Roman,serif" font-size="14.00">hidden_size : NoneType</text>
<text text-anchor="start" x="3859.5" y="-73.45" font-family="Times New Roman,serif" font-size="14.00">intermediate_size : NoneType</text>
<text text-anchor="start" x="3859.5" y="-56.95" font-family="Times New Roman,serif" font-size="14.00">up_proj : Linear</text>
<polyline fill="none" stroke="black" points="3851.5,-49.75 4031,-49.75"/>
<text text-anchor="start" x="3912" y="-32.45" font-family="Times New Roman,serif" font-size="14.00">forward(x)</text>
</g>
<!-- modeling_deepseek.DeepseekMLP&#45;&gt;modeling_deepseek.DeepseekDecoderLayer -->
<g id="edge10" class="edge">
<title>modeling_deepseek.DeepseekMLP&#45;&gt;modeling_deepseek.DeepseekDecoderLayer</title>
<path fill="none" stroke="black" d="M3926.29,-198.06C3918.41,-264.31 3915.55,-357.17 3944.5,-432.5 3964.12,-483.55 4002.06,-530.31 4038.73,-566.88"/>
<polygon fill="black" stroke="black" points="4038.79,-566.94 4045.88,-568.28 4047.37,-575.33 4040.29,-574 4038.79,-566.94"/>
<text text-anchor="middle" x="3955.38" y="-348.95" font-family="Times New Roman,serif" font-size="14.00" fill="green">mlp</text>
</g>
<!-- modeling_deepseek.DeepseekMoE -->
<g id="node10" class="node">
<title>modeling_deepseek.DeepseekMoE</title>
<polygon fill="none" stroke="black" points="3975.38,-276 3975.38,-432 4289.12,-432 4289.12,-276 3975.38,-276"/>
<text text-anchor="start" x="4092.12" y="-414.7" font-family="Times New Roman,serif" font-size="14.00">DeepseekMoE</text>
<polyline fill="none" stroke="black" points="3975.38,-407.5 4289.12,-407.5"/>
<text text-anchor="start" x="4073" y="-390.2" font-family="Times New Roman,serif" font-size="14.00">config</text>
<text text-anchor="start" x="4073" y="-373.7" font-family="Times New Roman,serif" font-size="14.00">experts : ModuleList</text>
<text text-anchor="start" x="4073" y="-357.2" font-family="Times New Roman,serif" font-size="14.00">gate</text>
<text text-anchor="start" x="4073" y="-340.7" font-family="Times New Roman,serif" font-size="14.00">num_experts_per_tok</text>
<text text-anchor="start" x="4073" y="-324.2" font-family="Times New Roman,serif" font-size="14.00">shared_experts</text>
<polyline fill="none" stroke="black" points="3975.38,-317 4289.12,-317"/>
<text text-anchor="start" x="3983.38" y="-299.7" font-family="Times New Roman,serif" font-size="14.00">forward(hidden_states)</text>
<text text-anchor="start" x="3983.38" y="-283.2" font-family="Times New Roman,serif" font-size="14.00">moe_infer(x, flat_expert_indices, flat_expert_weights)</text>
</g>
<!-- modeling_deepseek.DeepseekMLP&#45;&gt;modeling_deepseek.DeepseekMoE -->
<g id="edge11" class="edge">
<title>modeling_deepseek.DeepseekMLP&#45;&gt;modeling_deepseek.DeepseekMoE</title>
<path fill="none" stroke="black" d="M4001.56,-197.87C4016.16,-217.72 4031.97,-238.58 4047.25,-257.5 4049.43,-260.2 4051.66,-262.93 4053.93,-265.66"/>
<polygon fill="black" stroke="black" points="4053.98,-265.73 4060.9,-267.76 4061.69,-274.93 4054.77,-272.9 4053.98,-265.73"/>
<text text-anchor="middle" x="4087.75" y="-244.2" font-family="Times New Roman,serif" font-size="14.00" fill="green">shared_experts</text>
</g>
<!-- modeling_deepseek.DeepseekMoE&#45;&gt;modeling_deepseek.DeepseekDecoderLayer -->
<g id="edge12" class="edge">
<title>modeling_deepseek.DeepseekMoE&#45;&gt;modeling_deepseek.DeepseekDecoderLayer</title>
<path fill="none" stroke="black" d="M4132.25,-432.33C4132.25,-472.61 4132.25,-521.86 4132.25,-562.82"/>
<polygon fill="black" stroke="black" points="4132.25,-562.9 4136.25,-568.9 4132.25,-574.9 4128.25,-568.9 4132.25,-562.9"/>
<text text-anchor="middle" x="4143.12" y="-453.7" font-family="Times New Roman,serif" font-size="14.00" fill="green">mlp</text>
</g>
<!-- modeling_deepseek.DeepseekModel -->
<g id="node11" class="node">
<title>modeling_deepseek.DeepseekModel</title>
<polygon fill="none" stroke="black" points="5011,-551.5 5011,-740.5 7167.5,-740.5 7167.5,-551.5 5011,-551.5"/>
<text text-anchor="start" x="6045" y="-723.2" font-family="Times New Roman,serif" font-size="14.00">DeepseekModel</text>
<polyline fill="none" stroke="black" points="5011,-716 7167.5,-716"/>
<text text-anchor="start" x="6007.88" y="-698.7" font-family="Times New Roman,serif" font-size="14.00">embed_tokens : Embedding</text>
<text text-anchor="start" x="6007.88" y="-682.2" font-family="Times New Roman,serif" font-size="14.00">gradient_checkpointing : bool</text>
<text text-anchor="start" x="6007.88" y="-665.7" font-family="Times New Roman,serif" font-size="14.00">layers : ModuleList</text>
<text text-anchor="start" x="6007.88" y="-649.2" font-family="Times New Roman,serif" font-size="14.00">norm</text>
<text text-anchor="start" x="6007.88" y="-632.7" font-family="Times New Roman,serif" font-size="14.00">padding_idx</text>
<text text-anchor="start" x="6007.88" y="-616.2" font-family="Times New Roman,serif" font-size="14.00">vocab_size</text>
<polyline fill="none" stroke="black" points="5011,-609 7167.5,-609"/>
<text text-anchor="start" x="5019" y="-591.7" font-family="Times New Roman,serif" font-size="14.00">forward(input_ids: torch.LongTensor, attention_mask: Optional[torch.Tensor], position_ids: Optional[torch.LongTensor], past_key_values: Optional[List[torch.FloatTensor]], inputs_embeds: Optional[torch.FloatTensor], use_cache: Optional[bool], output_attentions: Optional[bool], output_hidden_states: Optional[bool], return_dict: Optional[bool]): Union[Tuple, BaseModelOutputWithPast]</text>
<text text-anchor="start" x="5019" y="-575.2" font-family="Times New Roman,serif" font-size="14.00">get_input_embeddings()</text>
<text text-anchor="start" x="5019" y="-558.7" font-family="Times New Roman,serif" font-size="14.00">set_input_embeddings(value)</text>
</g>
<!-- modeling_deepseek.DeepseekModel&#45;&gt;modeling_deepseek.DeepseekForCausalLM -->
<g id="edge13" class="edge">
<title>modeling_deepseek.DeepseekModel&#45;&gt;modeling_deepseek.DeepseekForCausalLM</title>
<path fill="none" stroke="black" d="M5466.98,-740.99C5315.04,-763.27 5152.87,-786.51 5002.25,-807 4877.19,-824.01 4745.28,-841.28 4615.33,-857.89"/>
<polygon fill="black" stroke="black" points="4615.56,-857.87 4610.11,-862.59 4603.65,-859.39 4609.1,-854.66 4615.56,-857.87"/>
<text text-anchor="middle" x="4878.13" y="-828.2" font-family="Times New Roman,serif" font-size="14.00" fill="green">model</text>
</g>
<!-- modeling_deepseek.DeepseekModel&#45;&gt;modeling_deepseek.DeepseekForSequenceClassification -->
<g id="edge14" class="edge">
<title>modeling_deepseek.DeepseekModel&#45;&gt;modeling_deepseek.DeepseekForSequenceClassification</title>
<path fill="none" stroke="black" d="M6089.25,-740.86C6089.25,-787.39 6089.25,-843.08 6089.25,-887.9"/>
<polygon fill="black" stroke="black" points="6089.25,-887.93 6093.25,-893.93 6089.25,-899.93 6085.25,-893.93 6089.25,-887.93"/>
<text text-anchor="middle" x="6106.5" y="-828.2" font-family="Times New Roman,serif" font-size="14.00" fill="green">model</text>
</g>
<!-- modeling_deepseek.DeepseekModel&#45;&gt;modeling_deepseek.DeepseekPreTrainedModel -->
<g id="edge6" class="edge">
<title>modeling_deepseek.DeepseekModel&#45;&gt;modeling_deepseek.DeepseekPreTrainedModel</title>
<path fill="none" stroke="black" d="M7008.81,-740.97C7276.65,-803.79 7458.89,-908.4 7297.25,-1082.5 7224.85,-1160.48 6511.84,-1171.26 6216.43,-1172.35"/>
<polygon fill="none" stroke="black" points="6216.75,-1168.85 6206.76,-1172.38 6216.77,-1175.85 6216.75,-1168.85"/>
</g>
<!-- modeling_deepseek.DeepseekRMSNorm -->
<g id="node13" class="node">
<title>modeling_deepseek.DeepseekRMSNorm</title>
<polygon fill="none" stroke="black" points="4307.5,-309 4307.5,-399 4451,-399 4451,-309 4307.5,-309"/>
<text text-anchor="start" x="4322.25" y="-381.7" font-family="Times New Roman,serif" font-size="14.00">DeepseekRMSNorm</text>
<polyline fill="none" stroke="black" points="4307.5,-374.5 4451,-374.5"/>
<text text-anchor="start" x="4315.5" y="-357.2" font-family="Times New Roman,serif" font-size="14.00">variance_epsilon : float</text>
<text text-anchor="start" x="4315.5" y="-340.7" font-family="Times New Roman,serif" font-size="14.00">weight : Parameter</text>
<polyline fill="none" stroke="black" points="4307.5,-333.5 4451,-333.5"/>
<text text-anchor="start" x="4316.62" y="-316.2" font-family="Times New Roman,serif" font-size="14.00">forward(hidden_states)</text>
</g>
<!-- modeling_deepseek.DeepseekRMSNorm&#45;&gt;modeling_deepseek.DeepseekDecoderLayer -->
<g id="edge15" class="edge">
<title>modeling_deepseek.DeepseekRMSNorm&#45;&gt;modeling_deepseek.DeepseekDecoderLayer</title>
<path fill="none" stroke="black" d="M4339.74,-399.48C4327.39,-411.45 4313.08,-423.55 4298.25,-432.5 4276.68,-445.52 4264.01,-434.56 4244.5,-450.5 4208.04,-480.3 4180.99,-525.28 4162.6,-564.48"/>
<polygon fill="black" stroke="black" points="4162.62,-564.43 4163.78,-571.55 4157.66,-575.35 4156.5,-568.23 4162.62,-564.43"/>
<text text-anchor="middle" x="4289.88" y="-453.7" font-family="Times New Roman,serif" font-size="14.00" fill="green">input_layernorm</text>
</g>
<!-- modeling_deepseek.DeepseekRMSNorm&#45;&gt;modeling_deepseek.DeepseekDecoderLayer -->
<g id="edge16" class="edge">
<title>modeling_deepseek.DeepseekRMSNorm&#45;&gt;modeling_deepseek.DeepseekDecoderLayer</title>
<path fill="none" stroke="black" d="M4367.22,-399.42C4360.06,-421.03 4349.55,-446.66 4335.25,-467 4309.06,-504.26 4273.51,-538.88 4239.48,-567.49"/>
<polygon fill="black" stroke="black" points="4239.39,-567.56 4237.32,-574.47 4230.15,-575.21 4232.22,-568.3 4239.39,-567.56"/>
<text text-anchor="middle" x="4413.7" y="-453.7" font-family="Times New Roman,serif" font-size="14.00" fill="green">post_attention_layernorm</text>
</g>
<!-- modeling_deepseek.DeepseekRMSNorm&#45;&gt;modeling_deepseek.DeepseekModel -->
<g id="edge17" class="edge">
<title>modeling_deepseek.DeepseekRMSNorm&#45;&gt;modeling_deepseek.DeepseekModel</title>
<path fill="none" stroke="black" d="M4451.36,-367.23C4633.32,-398.09 5124.92,-481.46 5522.41,-548.87"/>
<polygon fill="black" stroke="black" points="5522.31,-548.85 5528.9,-545.91 5534.14,-550.86 5527.56,-553.8 5522.31,-548.85"/>
<text text-anchor="middle" x="5045.43" y="-453.7" font-family="Times New Roman,serif" font-size="14.00" fill="green">norm</text>
</g>
<!-- modeling_deepseek.DeepseekRotaryEmbedding&#45;&gt;modeling_deepseek.DeepseekAttention -->
<g id="edge18" class="edge">
<title>modeling_deepseek.DeepseekRotaryEmbedding&#45;&gt;modeling_deepseek.DeepseekAttention</title>
<path fill="none" stroke="black" d="M646.76,-415.79C654.87,-433.09 664.13,-452.83 673.73,-473.31"/>
<polygon fill="black" stroke="black" points="673.78,-473.41 679.95,-477.15 678.88,-484.28 672.71,-480.55 673.78,-473.41"/>
<text text-anchor="middle" x="701.57" y="-453.7" font-family="Times New Roman,serif" font-size="14.00" fill="green">rotary_emb</text>
</g>
<!-- modeling_deepseek.DeepseekSdpaAttention -->
<g id="node15" class="node">
<title>modeling_deepseek.DeepseekSdpaAttention</title>
<polygon fill="none" stroke="black" points="2391,-329.5 2391,-378.5 3899.5,-378.5 3899.5,-329.5 2391,-329.5"/>
<text text-anchor="start" x="3080" y="-361.2" font-family="Times New Roman,serif" font-size="14.00">DeepseekSdpaAttention</text>
<polyline fill="none" stroke="black" points="2391,-354 3899.5,-354"/>
<polyline fill="none" stroke="black" points="2391,-354 3899.5,-354"/>
<text text-anchor="start" x="2399" y="-336.7" font-family="Times New Roman,serif" font-size="14.00">forward(hidden_states: torch.Tensor, attention_mask: Optional[torch.Tensor], position_ids: Optional[torch.LongTensor], past_key_value: Optional[Cache], output_attentions: bool, use_cache: bool): Tuple[torch.Tensor, Optional[torch.Tensor], Optional[Tuple[torch.Tensor]]]</text>
</g>
<!-- modeling_deepseek.DeepseekSdpaAttention&#45;&gt;modeling_deepseek.DeepseekAttention -->
<g id="edge7" class="edge">
<title>modeling_deepseek.DeepseekSdpaAttention&#45;&gt;modeling_deepseek.DeepseekAttention</title>
<path fill="none" stroke="black" d="M2947.55,-378.98C2637.54,-416.58 2020.72,-491.39 1519.96,-552.13"/>
<polygon fill="none" stroke="black" points="1519.9,-548.61 1510.39,-553.29 1520.74,-555.56 1519.9,-548.61"/>
</g>
<!-- modeling_deepseek.MoEGate -->
<g id="node16" class="node">
<title>modeling_deepseek.MoEGate</title>
<polygon fill="none" stroke="black" points="4055.25,-0.5 4055.25,-222.5 4209.25,-222.5 4209.25,-0.5 4055.25,-0.5"/>
<text text-anchor="start" x="4105.62" y="-205.2" font-family="Times New Roman,serif" font-size="14.00">MoEGate</text>
<polyline fill="none" stroke="black" points="4055.25,-198 4209.25,-198"/>
<text text-anchor="start" x="4080.5" y="-180.7" font-family="Times New Roman,serif" font-size="14.00">alpha</text>
<text text-anchor="start" x="4080.5" y="-164.2" font-family="Times New Roman,serif" font-size="14.00">config</text>
<text text-anchor="start" x="4080.5" y="-147.7" font-family="Times New Roman,serif" font-size="14.00">gating_dim</text>
<text text-anchor="start" x="4080.5" y="-131.2" font-family="Times New Roman,serif" font-size="14.00">n_routed_experts</text>
<text text-anchor="start" x="4080.5" y="-114.7" font-family="Times New Roman,serif" font-size="14.00">norm_topk_prob</text>
<text text-anchor="start" x="4080.5" y="-98.2" font-family="Times New Roman,serif" font-size="14.00">scoring_func</text>
<text text-anchor="start" x="4080.5" y="-81.7" font-family="Times New Roman,serif" font-size="14.00">seq_aux</text>
<text text-anchor="start" x="4080.5" y="-65.2" font-family="Times New Roman,serif" font-size="14.00">top_k</text>
<text text-anchor="start" x="4080.5" y="-48.7" font-family="Times New Roman,serif" font-size="14.00">weight : Parameter</text>
<polyline fill="none" stroke="black" points="4055.25,-41.5 4209.25,-41.5"/>
<text text-anchor="start" x="4063.25" y="-24.2" font-family="Times New Roman,serif" font-size="14.00">forward(hidden_states)</text>
<text text-anchor="start" x="4063.25" y="-7.7" font-family="Times New Roman,serif" font-size="14.00">reset_parameters(): None</text>
</g>
<!-- modeling_deepseek.MoEGate&#45;&gt;modeling_deepseek.DeepseekMoE -->
<g id="edge19" class="edge">
<title>modeling_deepseek.MoEGate&#45;&gt;modeling_deepseek.DeepseekMoE</title>
<path fill="none" stroke="black" d="M4132.25,-222.9C4132.25,-236.23 4132.25,-249.73 4132.25,-262.73"/>
<polygon fill="black" stroke="black" points="4132.25,-262.64 4136.25,-268.64 4132.25,-274.64 4128.25,-268.64 4132.25,-262.64"/>
<text text-anchor="middle" x="4143.5" y="-244.2" font-family="Times New Roman,serif" font-size="14.00" fill="green">gate</text>
</g>
</g>
</svg>
